{% extends '::base.html.twig' %}

{% block javascripts %}
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=visualization"></script>
<script>
  var map;

  function initialize() {
    var mapOptions = {
      zoom: 11,
      center: new google.maps.LatLng(-34.928727, 138.600769),
      mapTypeId: google.maps.MapTypeId.TERRAIN
    };

    map = new google.maps.Map(document.getElementById('map-canvas'),
          mapOptions);

    $.ajax({
      url: '{{ path('spaceapps_magnet_reading_recent') }}',
      context: document.body
    }).done(function(result) {
      var heatmapData = [];

      $.each(result.samples, function(index, sample) {
        var latLng = new google.maps.LatLng(sample.latitude, sample.longitude);
        heatmapData.push({ location: latLng, weight: sample.reading });
      });

      var heatmap = new google.maps.visualization.HeatmapLayer({
        data: heatmapData,
        map: map
      });
    });
  }

  google.maps.event.addDomListener(window, 'load', initialize);
</script>
{% endblock %}


{% block stylesheets %}
<style>
	html, body, #map-canvas {
		margin: 0;
		padding: 0;
		height: 100%;
	}
</style>
{% endblock %}


{% block body %}
<div id="map-canvas"></div>
{% endblock %}